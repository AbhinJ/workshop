<!DOCTYPE html>

<html lang="es">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>3. UN SDG3: Good Health and Well Being &#8212; Workshop - FOSS4G 2021 Argentina - Routing with pgRouting</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-sphinx.css" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/translations.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="next" title="4. UN SDG11: Sustainable Cities and Communities" href="chapter_4_sdg11.html" />
    <link rel="prev" title="2. Data for Sustainable Development Goals" href="chapter_2_get_data.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../index.html"><span><img src="../_static/pgrouting.png"></span>
          Workshop FOSS4G Argentina</a>
        <span class="navbar-text navbar-version pull-left"><b>2.7</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Chapters <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption" role="heading"><span class="caption-text">Taller</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general-intro/chapter-1.html">1. Introducción</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general-intro/chapter-2.html">2. Sobre El Taller</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../general-intro/chapter-2.html#pgrouting-overview">2.1. Visión General de pgRouting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general-intro/chapter-2.html#osm2pgrouting-overview">2.2. Visión General de osm2pgrouting</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general-intro/chapter-2.html#openstreetmap-overview">2.3. Visión general de OpenStreetMap</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../general-intro/chapter-3.html">3. Instalación</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../general-intro/chapter-3.html#osgeolive-on-a-virtualbox">3.1. OSGeoLive en una VirtualBox</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Basic</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../basic/chapter-4.html">1. Preparar Datos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-4.html#prepare-the-database">1.1. Preparar la base de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-4.html#get-the-workshop-data">1.2. Obtenga los Datos del Taller</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-4.html#upload-data-to-the-database">1.3. Cargar datos en la base de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-4.html#chapter-appendix">1.4. Capítulo: Apéndice</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/chapter-5.html">2. Algoritmos de pgRouting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-5.html#pgr-dijkstra">2.1. pgr_dijkstra</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-5.html#pgr-dijkstracost">2.2. pgr_dijkstraCost</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/chapter-6.html">3. Consultas avanzadas de ruteo</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-6.html#routing-for-vehicles">3.1. Ruteo para vehículos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-6.html#cost-manipulations">3.2. Manipulaciones de costes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/chapter-7.html">4. Escribir un Procedimiento Almacenado de SQL</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-7.html#the-application-requirements">4.1. Los requisitos de aplicación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-7.html#preparing-processing-graphs">4.2. Preparación de grafos de procesamiento</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-7.html#geometry-handling">4.3. Manejo de geometría</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-7.html#creating-the-function">4.4. Crear la función</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../basic/chapter-8.html">5. Escribir un pl/pgsql Procedimientos Almacenados</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-8.html#requirements-for-routing-from-a-to-b">5.1. Requisitos para el ruteo de A a B</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-8.html#the-vertex-table">5.2. La Tabla de Vértices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../basic/chapter-8.html#wrk-fromatob-function">5.3. función wrk_fromAtoB</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../advanced/chapter-12.html">1. Crear una topología de red</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../advanced/chapter-12.html#load-network-data">1.1. Cargar los datos de la red</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/chapter-12.html#create-a-routing-network-topology">1.2. Crear una Topología de Red de Ruteo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/chapter-12.html#verify-the-routing-network-topology">1.3. Verifique la Topología de Red de Ruteo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../advanced/chapter-12.html#analyze-and-adjust-the-routing-network-topology">1.4. Analizar y ajustar la Topología de Red de Ruteo</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">United Nations Sustainable Development Goals</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="chapter_1_introduction.html">1. Achieving Sustainable Development Goals with pgRouting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chapter_1_introduction.html#history">1.1. History</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter_1_introduction.html#united-nations">1.2. United Nations</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter_1_introduction.html#what-are-the-sustainable-development-goals">1.3. What are the Sustainable Development Goals?</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter_1_introduction.html#target-audience">1.4. Target Audience</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter_1_introduction.html#prerequisites-for-un-sdg-exercises">1.5. Prerequisites for UN SDG Exercises</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chapter_2_get_data.html">2. Data for Sustainable Development Goals</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chapter_2_get_data.html#work-directory-for-pgrouting-data-manipulation">2.1. Work Directory for pgRouting data manipulation</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter_2_get_data.html#mumbai-database">2.2. Mumbai database</a></li>
<li class="toctree-l2"><a class="reference internal" href="chapter_2_get_data.html#bangladesh-database">2.3. Bangladesh database</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">3. UN SDG3: Good Health and Well Being</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#exercise-travel-time-based-estimation-of-population-served-by-hospital">3.1. Exercise: Travel-Time based Estimation of Population Served by Hospital</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chapter_4_sdg11.html">4. UN SDG11: Sustainable Cities and Communities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chapter_4_sdg11.html#exercise-city-getting-affected-by-rain-or-not">4.1. Exercise: City getting affected by rain or not</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chapter_5_sdg7.html">5. UN SDG7: Affordable and Clean Energy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chapter_5_sdg7.html#exercise-optimising-the-electricity-distribution-network">5.1. Exercise: Optimising the Electricity Distribution Network</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Interaction with other software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../interactions/chapter-9.html">1. Uso de Qgis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-9.html#set-up-qgis">1.1. Configurar QGIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-9.html#add-a-postgis-layer">1.2. Añadir una Capa postGIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-9.html#format-a-routing-layer">1.3. Formatear una Capa de Ruteo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-9.html#copy-paste-format">1.4. Copiar/Pegar Formato</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-9.html#save-the-project">1.5. Guardar el proyecto</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../interactions/chapter-10.html">2. Servidor WMS con GeoServer</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-10.html#connect-to-the-administration-page">2.1. Conéctese a la página de administración</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-10.html#create-the-layer">2.2. Crear la capa</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../interactions/chapter-11.html">3. Interfaz de Ruteo Basada en OpenLayers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#openlayers-introduction">3.1. Introducción a OpenLayers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#creating-a-minimal-map">3.2. Crear un mapa mínimo</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#wms-get-parameters">3.3. Parámetros WMS GET</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#select-start-and-destination">3.4. Seleccione «inicio» y «destino»</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#clear-the-results">3.5. Borrar los resultados</a></li>
<li class="toctree-l2"><a class="reference internal" href="../interactions/chapter-11.html#summary-full-example">3.6. Resumen (ejemplo completo)</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples from the Internet</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/boost_dijkstra.html">1. Ejemplo de Boost Dijkstra</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/hanoslav.html">2. Ejemplos de Internet</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/wiki_example.html">3. Wikipedia Dijkstra Example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Apéndices</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../appendix/appendix-1.html">1. Apéndice: Soluciones del taller</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../appendix/appendix-1.html#solutions-to-basic-chapter-5">1.1. Solutions to <span class="xref std std-doc">../basic/chapter-5</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/appendix-1.html#solutions-to-basic-chapter-6">1.2. Solutions to <span class="xref std std-doc">../basic/chapter-6</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/appendix-1.html#solutions-to-basic-chapter-7">1.3. Solutions to <span class="xref std std-doc">../basic/chapter-7</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="../appendix/appendix-1.html#solutions-to-basic-chapter-8">1.4. Solutions to <span class="xref std std-doc">../basic/chapter-8</span></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/appendix-2.html">2. Apéndice: Instalación</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/appendix-3.html">3. Apéndice: Herramienta de Importación osm2pgrouting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../appendix/appendix-4.html">4. Tutoriales en Video para Taller</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../appendix/appendix-4.html#chapter-4">4.1. Capítulo 4</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Appendix_SDG.html">5. Appendix: OSGeo UN Challenge Workshop Solutions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="Appendix_SDG.html#solutions-to-chapter-3-sdg3">5.1. Solutions to <span class="xref std std-doc">chapter_3_sdg3</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="Appendix_SDG.html#solutions-to-chapter-4-sdg11">5.2. Solutions to <span class="xref std std-doc">chapter_4_sdg11</span></a></li>
<li class="toctree-l2"><a class="reference internal" href="Appendix_SDG.html#solutions-to-chapter-5-sdg7">5.3. Solutions to <span class="xref std std-doc">chapter_5_sdg7</span></a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">3. UN SDG3: Good Health and Well Being</a><ul>
<li><a class="reference internal" href="#exercise-travel-time-based-estimation-of-population-served-by-hospital">3.1. Exercise: Travel-Time based Estimation of Population Served by Hospital</a><ul>
<li><a class="reference internal" href="#pre-processing-roads-and-buildings-data">3.1.1. Pre-processing roads and buildings data</a><ul>
<li><a class="reference internal" href="#setting-the-search-path-for-roads-and-buildings">3.1.1.1. Setting the Search Path for roads and Buildings</a></li>
<li><a class="reference internal" href="#counting-the-number-of-roads-and-buildings">3.1.1.2. Counting the number of Roads and Buildings</a></li>
<li><a class="reference internal" href="#preprocessing-buildings">3.1.1.3. Preprocessing Buildings</a></li>
<li><a class="reference internal" href="#process-to-discard-disconnected-roads">3.1.1.4. Process to discard disconnected roads</a></li>
</ul>
</li>
<li><a class="reference internal" href="#finding-the-travel-time-based-the-roads-served-of-hospital">3.1.2. Finding the travel-time based the roads served of hospital</a><ul>
<li><a class="reference internal" href="#finding-the-closest-road-vertex">3.1.2.1. Finding the closest road vertex</a></li>
<li><a class="reference internal" href="#finding-the-roads-served">3.1.2.2. Finding the roads served</a></li>
<li><a class="reference internal" href="#generalising-the-roads-served">3.1.2.3. Generalising the roads served</a></li>
</ul>
</li>
<li><a class="reference internal" href="#calculating-the-population-residing-along-the-road">3.1.3. Calculating the population residing along the road</a><ul>
<li><a class="reference internal" href="#estimating-the-population-of-buildings">3.1.3.1. Estimating the population of buildings</a></li>
<li><a class="reference internal" href="#finding-the-nearest-roads-to-store-the-population">3.1.3.2. Finding the nearest roads to store the population</a></li>
<li><a class="reference internal" href="#storing-the-population-in-the-roads">3.1.3.3. Storing the population in the roads</a></li>
</ul>
</li>
<li><a class="reference internal" href="#finding-total-population-served-by-the-hospital-based-on-travel-time">3.1.4. Finding total population served by the hospital based on travel-time</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
              
                
  <li>
    <a href="chapter_2_get_data.html" title="Previous Chapter: 2. Data for Sustainable Development Goals"><span class="glyphicon glyphicon-chevron-left visible-sm"></span><span class="hidden-sm hidden-tablet">&laquo; 2. Data for S...</span>
    </a>
  </li>
  <li>
    <a href="chapter_4_sdg11.html" title="Next Chapter: 4. UN SDG11: Sustainable Cities and Communities"><span class="glyphicon glyphicon-chevron-right visible-sm"></span><span class="hidden-sm hidden-tablet">4. UN SDG11: ... &raquo;</span>
    </a>
  </li>
              
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <section id="un-sdg3-good-health-and-well-being">
<h1><a class="toc-backref" href="#id1"><span class="section-number">3. </span>UN SDG3: Good Health and Well Being</a><a class="headerlink" href="#un-sdg3-good-health-and-well-being" title="Enlazar permanentemente con este título">¶</a></h1>
<p>SDG 3 aspires to ensure health and well-being for all, including a bold
commitment to end the epidemics of AIDS, tuberculosis, malaria and other
communicable diseases by 2030. It also aims to achieve universal health
coverage, and provide access to safe and effective medicines and vaccines for
all. Supporting research and development for vaccines is an essential part of
this process as well as expanding access to affordable medicines. It is very
important to estimate the area served by the hospital for better planning which
would ultimately help in achieving universal coverage.</p>
<img alt="../_images/un_sdg3.png" class="align-center" src="../_images/un_sdg3.png" />
<div class="contents topic" id="chapter-contents">
<p class="topic-title">Chapter Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#un-sdg3-good-health-and-well-being" id="id1">UN SDG3: Good Health and Well Being</a></p>
<ul>
<li><p><a class="reference internal" href="#exercise-travel-time-based-estimation-of-population-served-by-hospital" id="id2">Exercise: Travel-Time based Estimation of Population Served by Hospital</a></p>
<ul>
<li><p><a class="reference internal" href="#pre-processing-roads-and-buildings-data" id="id3">Pre-processing roads and buildings data</a></p>
<ul>
<li><p><a class="reference internal" href="#setting-the-search-path-for-roads-and-buildings" id="id4">Setting the Search Path for roads and Buildings</a></p></li>
<li><p><a class="reference internal" href="#counting-the-number-of-roads-and-buildings" id="id5">Counting the number of Roads and Buildings</a></p></li>
<li><p><a class="reference internal" href="#preprocessing-buildings" id="id6">Preprocessing Buildings</a></p></li>
<li><p><a class="reference internal" href="#process-to-discard-disconnected-roads" id="id7">Process to discard disconnected roads</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#finding-the-travel-time-based-the-roads-served-of-hospital" id="id8">Finding the travel-time based the roads served of hospital</a></p>
<ul>
<li><p><a class="reference internal" href="#finding-the-closest-road-vertex" id="id9">Finding the closest road vertex</a></p></li>
<li><p><a class="reference internal" href="#finding-the-roads-served" id="id10">Finding the roads served</a></p></li>
<li><p><a class="reference internal" href="#generalising-the-roads-served" id="id11">Generalising the roads served</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#calculating-the-population-residing-along-the-road" id="id12">Calculating the population residing along the road</a></p>
<ul>
<li><p><a class="reference internal" href="#estimating-the-population-of-buildings" id="id13">Estimating the population of buildings</a></p></li>
<li><p><a class="reference internal" href="#finding-the-nearest-roads-to-store-the-population" id="id14">Finding the nearest roads to store the population</a></p></li>
<li><p><a class="reference internal" href="#storing-the-population-in-the-roads" id="id15">Storing the population in the roads</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#finding-total-population-served-by-the-hospital-based-on-travel-time" id="id16">Finding total population served by the hospital based on travel-time</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<section id="exercise-travel-time-based-estimation-of-population-served-by-hospital">
<h2><a class="toc-backref" href="#id2"><span class="section-number">3.1. </span>Exercise: Travel-Time based Estimation of Population Served by Hospital</a><a class="headerlink" href="#exercise-travel-time-based-estimation-of-population-served-by-hospital" title="Enlazar permanentemente con este título">¶</a></h2>
<p><strong>Problem Statement</strong></p>
<p>To determine the population served by a hospital based on travel time</p>
<p><strong>Core Idea</strong></p>
<p>Population residing along the roads which reach to a hospital within a particular
time is dependant on that hospital.</p>
<p><strong>Approach</strong></p>
<ul class="simple">
<li><p>To prepare a dataset with:</p>
<ul>
<li><p>Nodes: Probable hospital locations</p></li>
<li><p>Edges: Roads</p></li>
<li><p>Polygons: Buildings with population</p></li>
</ul>
</li>
<li><p>Find the travel-time based the roads served</p></li>
<li><p>Estimate the population of the buildings</p></li>
<li><p>Find the nearest road to the buildings</p></li>
<li><p>Store the sum of population of nearest buildings in roads table</p></li>
<li><p>Find the sum of population on all the roads in the roads served</p></li>
</ul>
<section id="pre-processing-roads-and-buildings-data">
<h3><a class="toc-backref" href="#id3"><span class="section-number">3.1.1. </span>Pre-processing roads and buildings data</a><a class="headerlink" href="#pre-processing-roads-and-buildings-data" title="Enlazar permanentemente con este título">¶</a></h3>
<p>First step is to pre-process the data obtained from Chapter-2. The sub heads from
<code class="docutils literal notranslate"><span class="pre">Setting</span> <span class="pre">the</span> <span class="pre">Search</span> <span class="pre">Path</span></code> to <code class="docutils literal notranslate"><span class="pre">Process</span> <span class="pre">to</span> <span class="pre">discard</span> <span class="pre">disconnected</span> <span class="pre">roads</span></code> explain
the pre-processing steps.</p>
<section id="setting-the-search-path-for-roads-and-buildings">
<h4><a class="toc-backref" href="#id4"><span class="section-number">3.1.1.1. </span>Setting the Search Path for roads and Buildings</a><a class="headerlink" href="#setting-the-search-path-for-roads-and-buildings" title="Enlazar permanentemente con este título">¶</a></h4>
<p>First step in pre processing is to set the search path for <code class="docutils literal notranslate"><span class="pre">Roads</span></code> and <code class="docutils literal notranslate"><span class="pre">Buildings</span></code>
data. <cite>Search path</cite> is a list of schemas helps the system determine how a particular
table is to be imported. In this case, search path of roads table is set to roads
and buildings schema.``dn`` is used to list down all the present schemas.
<code class="docutils literal notranslate"><span class="pre">SHOW</span> <span class="pre">search_path</span></code> command shows the current search path. <code class="docutils literal notranslate"><span class="pre">SET</span> <span class="pre">search_path</span></code>
is used to set the search path to <code class="docutils literal notranslate"><span class="pre">roads</span></code> and <code class="docutils literal notranslate"><span class="pre">buildings</span></code>. Finally, <code class="docutils literal notranslate"><span class="pre">\dt</span></code>
is used to verify if the Schema have bees changed correctly. Following code snippets
show the steps as well as the outputs.</p>
<p><strong>1. Enumerate all the schemas</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="se">\d</span>n
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>   List of schemas
   Name    <span class="p">|</span>  Owner
-----------+----------
 buildings <span class="p">|</span> swapnil
 public    <span class="p">|</span> postgres
 roads     <span class="p">|</span> swapnil
<span class="o">(</span><span class="m">3</span> rows<span class="o">)</span>
</pre></div>
</div>
<p><strong>2. Show the current search path</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>SHOW search_path<span class="p">;</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>   search_path
-----------------
 <span class="s2">&quot;</span><span class="nv">$user</span><span class="s2">&quot;</span>, public
<span class="o">(</span><span class="m">1</span> row<span class="o">)</span>
</pre></div>
</div>
<p><strong>3. Set the search path</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>SET search_path TO roads,buildings,public<span class="p">;</span>
SHOW search_path<span class="p">;</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>    search_path
-------------------
roads, buildings, public
<span class="o">(</span><span class="m">1</span> row<span class="o">)</span>
</pre></div>
</div>
<p><strong>4. Enumerate all the tables</strong></p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="se">\d</span>t
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>                     List of relations
  Schema   <span class="p">|</span>            Name             <span class="p">|</span> Type  <span class="p">|</span>  Owner
-----------+-----------------------------+-------+---------
 buildings <span class="p">|</span> buildings_pointsofinterest  <span class="p">|</span> table <span class="p">|</span> user
 buildings <span class="p">|</span> buildings_ways              <span class="p">|</span> table <span class="p">|</span> user
 buildings <span class="p">|</span> buildings_ways_vertices_pgr <span class="p">|</span> table <span class="p">|</span> user
 public    <span class="p">|</span> spatial_ref_sys             <span class="p">|</span> table <span class="p">|</span> swapnil
 roads     <span class="p">|</span> configuration               <span class="p">|</span> table <span class="p">|</span> user
 roads     <span class="p">|</span> roads_pointsofinterest      <span class="p">|</span> table <span class="p">|</span> user
 roads     <span class="p">|</span> roads_ways                  <span class="p">|</span> table <span class="p">|</span> user
 roads     <span class="p">|</span> roads_ways_vertices_pgr     <span class="p">|</span> table <span class="p">|</span> user
<span class="o">(</span><span class="m">8</span> rows<span class="o">)</span>
</pre></div>
</div>
</section>
<section id="counting-the-number-of-roads-and-buildings">
<h4><a class="toc-backref" href="#id5"><span class="section-number">3.1.1.2. </span>Counting the number of Roads and Buildings</a><a class="headerlink" href="#counting-the-number-of-roads-and-buildings" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Counting the number of edges present in the gives the information if the amount
of data. Also, some of the rows can be seen to  understand the structure of the
table and how the data is stored in it.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">-- Counting the number of Edges of roads</span>
<span class="linenos">2</span><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">roads_ways</span><span class="p">;</span>
<span class="linenos">3</span>
<span class="linenos">4</span><span class="c1">-- Counting the number of Vertices of roads</span>
<span class="linenos">5</span><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">roads_ways_vertices_pgr</span><span class="p">;</span>
<span class="linenos">6</span>
<span class="linenos">7</span><span class="c1">-- Counting the number of buildings </span>
<span class="linenos">8</span><span class="k">SELECT</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">buildings_ways</span><span class="p">;</span>
</pre></div>
</div>
<p>Following image shows the roads and buildings visualised in <code class="docutils literal notranslate"><span class="pre">QGIS</span></code></p>
<a class="reference internal image-reference" href="../_images/roads_and_buildings.png"><img alt="../_images/roads_and_buildings.png" class="align-center" src="../_images/roads_and_buildings.png" style="width: 472.5px; height: 457.5px;" /></a>
</section>
<section id="preprocessing-buildings">
<h4><a class="toc-backref" href="#id6"><span class="section-number">3.1.1.3. </span>Preprocessing Buildings</a><a class="headerlink" href="#preprocessing-buildings" title="Enlazar permanentemente con este título">¶</a></h4>
<p>The table <code class="docutils literal notranslate"><span class="pre">buildings_ways</span></code> contains the buildings in edge form. They have to be
converted into polygons. Also, polygons with less than 3 points/vertices are not
considered valid polygons in PostgreSQL. Hence, the buildings having less than 3
vertices need to be cleaned up. Follow the steps given below to complete this task.</p>
<p><strong>1. Add a spatial column to the table to store the Polygon Geometry</strong></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">SELECT</span> <span class="n">AddGeometryColumn</span><span class="p">(</span><span class="s1">&#39;buildings&#39;</span><span class="p">,</span><span class="s1">&#39;buildings_ways&#39;</span><span class="p">,</span><span class="s1">&#39;poly_geom&#39;</span><span class="p">,</span><span class="mi">4326</span><span class="p">,</span><span class="s1">&#39;POLYGON&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>2. Removing the polygons with less less than 4 points</strong></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">ST_NumPoints</span></code> is used to find the number of points per edge.</p>
</div></blockquote>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">buildings_ways</span> 
<span class="linenos">2</span><span class="k">WHERE</span> <span class="n">ST_NumPoints</span><span class="p">(</span><span class="n">the_geom</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">4</span> 
<span class="linenos">3</span><span class="k">OR</span> <span class="n">ST_IsClosed</span><span class="p">(</span><span class="n">the_geom</span><span class="p">)</span> <span class="o">=</span> <span class="k">false</span><span class="p">;</span>
</pre></div>
</div>
<p><strong>3. Creating the polygons</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">ST_MakePolygons</span></code> is used to make the polygons. This step stores the geom of
polygons in the <code class="docutils literal notranslate"><span class="pre">poly_geom</span></code> column which was created earlier.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">UPDATE</span> <span class="n">buildings_ways</span> 
<span class="linenos">2</span><span class="k">SET</span> <span class="n">poly_geom</span> <span class="o">=</span> <span class="n">ST_MakePolygon</span><span class="p">(</span><span class="n">the_geom</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>4. Adding a column for storing the area</strong></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">buildings_ways</span>
<span class="linenos">2</span><span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">area</span> <span class="nb">INTEGER</span><span class="p">;</span>
</pre></div>
</div>
<p><strong>5. Calculating the area</strong></p>
<p><code class="docutils literal notranslate"><span class="pre">ST_Area</span></code> is used to calculate area of polygons. Area is stored in the
new column</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">UPDATE</span> <span class="n">buildings_ways</span> 
<span class="linenos">2</span><span class="k">SET</span> <span class="n">area</span> <span class="o">=</span> <span class="n">ST_Area</span><span class="p">(</span><span class="n">poly_geom</span><span class="p">::</span><span class="n">geography</span><span class="p">)::</span><span class="nb">INTEGER</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="process-to-discard-disconnected-roads">
<h4><a class="toc-backref" href="#id7"><span class="section-number">3.1.1.4. </span>Process to discard disconnected roads</a><a class="headerlink" href="#process-to-discard-disconnected-roads" title="Enlazar permanentemente con este título">¶</a></h4>
<p>pgRouting algorithms are only useful when the road network belongs to a single
graph (or all the roads are connected to each other). Hence, the disconnected
roads have to be removed from their network to get appropriate results.
This image gives an example of the disconnected edges.</p>
<img alt="../_images/remove_disconnected_roads.png" class="align-center" src="../_images/remove_disconnected_roads.png" />
<p>Follow the steps given below to complete this task.</p>
<p><strong>1. Add a column named</strong> <code class="docutils literal notranslate"><span class="pre">component</span></code> <strong>to store component number.</strong></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">roads_ways_vertices_pgr</span>
<span class="linenos">2</span><span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">component</span> <span class="nb">INTEGER</span><span class="p">;</span>
</pre></div>
</div>
<p><strong>2. Update the</strong> <code class="docutils literal notranslate"><span class="pre">component</span></code> <strong>column in</strong> <code class="docutils literal notranslate"><span class="pre">roads_ways_vertices_pgr</span></code> <strong>with the component number</strong></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">UPDATE</span> <span class="n">roads_ways_vertices_pgr</span> 
<span class="linenos"> 2</span><span class="k">SET</span> <span class="n">component</span> <span class="o">=</span> <span class="n">subquery</span><span class="p">.</span><span class="n">component</span> 
<span class="linenos"> 3</span><span class="k">FROM</span> <span class="p">(</span>
<span class="linenos"> 4</span>	<span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">pgr_connectedComponents</span><span class="p">(</span>
<span class="linenos"> 5</span>		<span class="s1">&#39;SELECT gid AS id, source, target, cost, reverse_cost </span>
<span class="linenos"> 6</span><span class="s1">		FROM roads_ways&#39;</span>
<span class="linenos"> 7</span>			<span class="p">)</span>
<span class="linenos"> 8</span>		<span class="p">)</span> 
<span class="linenos"> 9</span><span class="k">AS</span> <span class="n">subquery</span>
<span class="linenos">10</span><span class="k">WHERE</span> <span class="n">id</span> <span class="o">=</span> <span class="n">node</span><span class="p">;</span>
</pre></div>
</div>
<p>This will store the component number of each edge in the table. Now, the completely
connected network of roads should have the maximum count in the <code class="docutils literal notranslate"><span class="pre">componenet</span></code> table.
For example,there are 100 roads in a network and 3 are disconnected. 97 connected
roads will have the same component number, say 1. If there are 3 disconnected roads
have the connected component number, say 2, write a query to remove all the edges
with the component number 2.</p>
<p><strong>3. Finding the components which are to be removed</strong></p>
<p>This query selects all the components which are not equal to the component number
with maximum count using a subquery which groups the rows in <code class="docutils literal notranslate"><span class="pre">roads_ways_vertices_pgr</span></code>
by the component.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">WITH</span>
<span class="linenos">2</span><span class="n">subquery</span> <span class="k">AS</span> <span class="p">(</span>
<span class="linenos">3</span>	<span class="k">SELECT</span> <span class="n">component</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> 
<span class="linenos">4</span>	<span class="k">FROM</span> <span class="n">roads_ways_vertices_pgr</span> 
<span class="linenos">5</span>	<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">component</span>
<span class="linenos">6</span>	<span class="p">)</span>
<span class="linenos">7</span><span class="k">SELECT</span> <span class="n">component</span> <span class="k">FROM</span> <span class="n">subquery</span> 
<span class="linenos">8</span><span class="k">WHERE</span> <span class="k">count</span> <span class="o">!=</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">max</span><span class="p">(</span><span class="k">count</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">subquery</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>4. Finding the road vertices which belong to those components which are to be removed</strong></p>
<p>This query selects all the road vertices which have the component number from step 3.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">WITH</span>
<span class="linenos"> 2</span><span class="n">subquery</span> <span class="k">AS</span> <span class="p">(</span>
<span class="linenos"> 3</span>	<span class="k">SELECT</span> <span class="n">component</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> 
<span class="linenos"> 4</span>	<span class="k">FROM</span> <span class="n">roads_ways_vertices_pgr</span> 
<span class="linenos"> 5</span>	<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">component</span>
<span class="linenos"> 6</span>	<span class="p">),</span>
<span class="linenos"> 7</span><span class="n">to_remove</span> <span class="k">AS</span> <span class="p">(</span>
<span class="linenos"> 8</span>	<span class="k">SELECT</span> <span class="n">component</span> <span class="k">FROM</span> <span class="n">subquery</span> 
<span class="linenos"> 9</span>	<span class="k">WHERE</span> <span class="k">count</span> <span class="o">!=</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">max</span><span class="p">(</span><span class="k">count</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">subquery</span><span class="p">)</span>
<span class="linenos">10</span>	<span class="p">)</span>
<span class="linenos">11</span><span class="k">SELECT</span> <span class="n">id</span> <span class="k">FROM</span> <span class="n">roads_ways_vertices_pgr</span> 
<span class="linenos">12</span><span class="k">WHERE</span> <span class="n">component</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">to_remove</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>5. Removing the unwanted edges</strong></p>
<p>In <code class="docutils literal notranslate"><span class="pre">roads_ways</span></code> table (edge table) <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">target</span></code> have the <code class="docutils literal notranslate"><span class="pre">id</span></code> of
the vertices from where the edge starts and ends. To delete all the disconnected
edges the following query takes the output from the query of Step 4 and deletes
all the edges having the same <code class="docutils literal notranslate"><span class="pre">source</span></code> as the <code class="docutils literal notranslate"><span class="pre">id</span></code>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">roads_ways</span> <span class="k">WHERE</span> <span class="k">source</span> <span class="k">IN</span> <span class="p">(</span>
<span class="linenos"> 2</span>	<span class="k">WITH</span>
<span class="linenos"> 3</span>	<span class="n">subquery</span> <span class="k">AS</span> <span class="p">(</span>
<span class="linenos"> 4</span>		<span class="k">SELECT</span> <span class="n">component</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> 
<span class="linenos"> 5</span>		<span class="k">FROM</span> <span class="n">roads_ways_vertices_pgr</span> 
<span class="linenos"> 6</span>		<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">component</span>
<span class="linenos"> 7</span>		<span class="p">),</span>
<span class="linenos"> 8</span>	<span class="n">to_remove</span> <span class="k">AS</span> <span class="p">(</span>
<span class="linenos"> 9</span>		<span class="k">SELECT</span> <span class="n">component</span> <span class="k">FROM</span> <span class="n">subquery</span> 
<span class="linenos">10</span>		<span class="k">WHERE</span> <span class="k">count</span> <span class="o">!=</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">max</span><span class="p">(</span><span class="k">count</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">subquery</span><span class="p">)</span>
<span class="linenos">11</span>		<span class="p">)</span>
<span class="linenos">12</span>	<span class="k">SELECT</span> <span class="n">id</span> <span class="k">FROM</span> <span class="n">roads_ways_vertices_pgr</span> 
<span class="linenos">13</span>	<span class="k">WHERE</span> <span class="n">component</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">to_remove</span><span class="p">)</span>
<span class="linenos">14</span><span class="p">);</span>
</pre></div>
</div>
<p><strong>6. Removing unused vertices</strong></p>
<p>The following query uses the output of Step 4 to remove the vertices of the disconnected
edges.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">WITH</span>
<span class="linenos"> 2</span><span class="n">subquery</span> <span class="k">AS</span> <span class="p">(</span>
<span class="linenos"> 3</span>	<span class="k">SELECT</span> <span class="n">component</span><span class="p">,</span> <span class="k">count</span><span class="p">(</span><span class="o">*</span><span class="p">)</span> 
<span class="linenos"> 4</span>	<span class="k">FROM</span> <span class="n">roads_ways_vertices_pgr</span> 
<span class="linenos"> 5</span>	<span class="k">GROUP</span> <span class="k">BY</span> <span class="n">component</span>
<span class="linenos"> 6</span>	<span class="p">),</span>
<span class="linenos"> 7</span><span class="n">to_remove</span> <span class="k">AS</span> <span class="p">(</span>
<span class="linenos"> 8</span>	<span class="k">SELECT</span> <span class="n">component</span> <span class="k">FROM</span> <span class="n">subquery</span> 
<span class="linenos"> 9</span>	<span class="k">WHERE</span> <span class="k">count</span> <span class="o">!=</span> <span class="p">(</span><span class="k">SELECT</span> <span class="k">max</span><span class="p">(</span><span class="k">count</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">subquery</span><span class="p">)</span>
<span class="linenos">10</span>	<span class="p">)</span>
<span class="linenos">11</span><span class="k">DELETE</span> <span class="k">FROM</span> <span class="n">roads_ways_vertices_pgr</span> 
<span class="linenos">12</span><span class="k">WHERE</span> <span class="n">component</span> <span class="k">IN</span> <span class="p">(</span><span class="k">SELECT</span> <span class="o">*</span> <span class="k">FROM</span> <span class="n">to_remove</span><span class="p">);</span>
</pre></div>
</div>
</section>
</section>
<section id="finding-the-travel-time-based-the-roads-served-of-hospital">
<h3><a class="toc-backref" href="#id8"><span class="section-number">3.1.2. </span>Finding the travel-time based the roads served of hospital</a><a class="headerlink" href="#finding-the-travel-time-based-the-roads-served-of-hospital" title="Enlazar permanentemente con este título">¶</a></h3>
<p>After pre-processing the data, next step is to find the area served by the
hospital. This area can be computed from the entrance of the hospital or from any
point on road near the hospital. In this exercise it is computed from closest
road vertex. <code class="docutils literal notranslate"><span class="pre">pgr_drivingDistance</span></code> will be used to find the roads served. The
steps to be followed are:</p>
<ul class="simple">
<li><p>Finding the closest road vertex</p></li>
<li><p>Finding the roads served</p></li>
<li><p>Generalising the roads served</p></li>
</ul>
<section id="finding-the-closest-road-vertex">
<h4><a class="toc-backref" href="#id9"><span class="section-number">3.1.2.1. </span>Finding the closest road vertex</a><a class="headerlink" href="#finding-the-closest-road-vertex" title="Enlazar permanentemente con este título">¶</a></h4>
<p>There are multiple road vertices near the hospital. Create a function to find
the geographically closest road vertex.</p>
<a class="reference internal image-reference" href="../_images/finding_closest_vertex.png"><img alt="../_images/finding_closest_vertex.png" class="align-center" src="../_images/finding_closest_vertex.png" style="width: 606.75px; height: 450.75px;" /></a>
<p><code class="docutils literal notranslate"><span class="pre">closest_vertex</span></code> function takes geometry of other table as input and gives
the gid of the closest vertex as output by comparing <code class="docutils literal notranslate"><span class="pre">geom</span></code> of both the tables.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>CREATE OR REPLACE FUNCTION closest_vertex(geom GEOMETRY)
<span class="linenos">2</span>RETURNS BIGINT AS
<span class="linenos">3</span>$BODY$
<span class="linenos">4</span>SELECT id FROM roads_ways_vertices_pgr ORDER BY geom &lt;-&gt; the_geom LIMIT 1;
<span class="linenos">5</span>$BODY$
<span class="linenos">6</span>LANGUAGE SQL;
</pre></div>
</div>
</section>
<section id="finding-the-roads-served">
<h4><a class="toc-backref" href="#id10"><span class="section-number">3.1.2.2. </span>Finding the roads served</a><a class="headerlink" href="#finding-the-roads-served" title="Enlazar permanentemente con este título">¶</a></h4>
<p>In this exercise, the roads served based on travel-time is calculated. This can be
calculated using <code class="docutils literal notranslate"><span class="pre">pgrdrivingDistance</span></code> function of pgRouting. Time in minutes is
considered as <code class="docutils literal notranslate"><span class="pre">cost</span></code>. The <code class="docutils literal notranslate"><span class="pre">agg_cost</span></code> column would show the time required to
reach the hospital.</p>
<p>For the following query,</p>
<ul class="simple">
<li><p>In line 3, Pedestrian speed is assumed to be as <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">m/s</span></code>. As <code class="docutils literal notranslate"><span class="pre">time</span></code> = <code class="docutils literal notranslate"><span class="pre">distance/speed</span></code>,
<code class="docutils literal notranslate"><span class="pre">length_m</span></code> / <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">m/s</span></code> / <code class="docutils literal notranslate"><span class="pre">60</span></code> gives the time in minutes.</p></li>
<li><p>In line 7, <code class="docutils literal notranslate"><span class="pre">tag_id</span> <span class="pre">=</span> <span class="pre">'318'</span></code>  as 318 is the tag_id of hospital in the configuration
file of buildings.</p></li>
<li><p>In line 8, <code class="docutils literal notranslate"><span class="pre">10</span></code> is written for 10 minutes which is a threshold for <code class="docutils literal notranslate"><span class="pre">agg_cost</span></code>.</p></li>
<li><p>In line 8, <code class="docutils literal notranslate"><span class="pre">FALSE</span></code> is written as the query is for undirected graph.</p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">SELECT</span> <span class="n">gid</span><span class="p">,</span><span class="k">source</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="n">agg_cost</span><span class="p">,</span><span class="n">r</span><span class="p">.</span><span class="n">the_geom</span>
<span class="linenos"> 2</span><span class="k">FROM</span> <span class="n">pgr_drivingDistance</span><span class="p">(</span>
<span class="linenos"> 3</span>        <span class="s1">&#39;SELECT gid as id,source,target, length_m/60 AS cost,length_m/60 AS reverse_cost </span>
<span class="linenos"> 4</span><span class="s1">        FROM roads.roads_ways&#39;</span><span class="p">,</span>
<span class="linenos"> 5</span>        <span class="p">(</span><span class="k">SELECT</span> <span class="n">closest_vertex</span><span class="p">(</span><span class="n">poly_geom</span><span class="p">)</span> 
<span class="linenos"> 6</span>        <span class="k">FROM</span> <span class="n">buildings</span><span class="p">.</span><span class="n">buildings_ways</span> 
<span class="linenos"> 7</span>        <span class="k">WHERE</span> <span class="n">tag_id</span> <span class="o">=</span> <span class="s1">&#39;318&#39;</span>
<span class="linenos"> 8</span>        <span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="k">FALSE</span>
<span class="linenos"> 9</span>      <span class="p">),</span> <span class="n">roads</span><span class="p">.</span><span class="n">roads_ways</span> <span class="k">AS</span> <span class="n">r</span>
<span class="linenos">10</span><span class="k">WHERE</span> <span class="n">edge</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">gid</span> 
<span class="linenos">11</span><span class="k">LIMIT</span> <span class="mi">10</span><span class="p">;</span>
</pre></div>
</div>
<p>Following figure shows the output of the above query visualised in QGIS. The lines
highlighted by <code class="docutils literal notranslate"><span class="pre">red</span></code> colour show the area from where the hospital can be reached
within 10 minutes of walking at <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">m/s</span></code>. It is evident from the output figure
that some of the roads which are near to the hospital are not highlighted. For
example, to roads in the north of the hospital. This is because the only one edge
per road vertex was selected by the query. Next session will solve this issue by
doing a little modification in the query.</p>
<a class="reference internal image-reference" href="../_images/service_area.png"><img alt="../_images/service_area.png" class="align-center" src="../_images/service_area.png" style="width: 566.25px; height: 559.5px;" /></a>
</section>
<section id="generalising-the-roads-served">
<h4><a class="toc-backref" href="#id11"><span class="section-number">3.1.2.3. </span>Generalising the roads served</a><a class="headerlink" href="#generalising-the-roads-served" title="Enlazar permanentemente con este título">¶</a></h4>
<p>The edges which are near to to hospital should also be selected in the roads served
as the hospital also serves those buildings. The following query takes the query
from previous section as a <code class="docutils literal notranslate"><span class="pre">subquery</span></code> and selects all the edges from <code class="docutils literal notranslate"><span class="pre">roads_ways</span></code>
that have the same <code class="docutils literal notranslate"><span class="pre">source</span></code> and <code class="docutils literal notranslate"><span class="pre">target</span></code> to that of <code class="docutils literal notranslate"><span class="pre">subquery</span></code> (Line 14).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>WITH subquery AS (
<span class="linenos"> 2</span>SELECT r.gid, edge,source,target,agg_cost,r.the_geom 
<span class="linenos"> 3</span>FROM pgr_drivingDistance(
<span class="linenos"> 4</span>        &#39;SELECT gid as id,source,target, length_m/60 AS cost, length_m/60 AS reverse_cost 
<span class="linenos"> 5</span>        FROM roads.roads_ways&#39;,
<span class="linenos"> 6</span>        (SELECT closest_vertex(poly_geom) 
<span class="linenos"> 7</span>        FROM buildings.buildings_ways 
<span class="linenos"> 8</span>        WHERE tag_id = &#39;318&#39;
<span class="linenos"> 9</span>        ), 10, FALSE
<span class="linenos">10</span>      ),roads.roads_ways AS r
<span class="linenos">11</span>WHERE edge = r.gid)
<span class="linenos">12</span>SELECT r.gid, s.source, s.target, s.agg_cost
<span class="linenos">13</span>FROM subquery AS s, roads.roads_ways AS r 
<span class="linenos">14</span>WHERE r.source = s.source OR r.target = s.target
<span class="linenos">15</span>ORDER BY r.gid;
<span class="linenos">16</span>-- Calculating the population residing along the road
<span class="linenos">17</span>
<span class="linenos">18</span>
<span class="linenos">19</span>-- population_function_from_here
<span class="linenos">20</span>CREATE OR REPLACE FUNCTION  population(tag_id INTEGER,area INTEGER)
<span class="linenos">21</span>RETURNS INTEGER AS 
<span class="linenos">22</span>$BODY$
<span class="linenos">23</span>DECLARE 
<span class="linenos">24</span>population INTEGER;
<span class="linenos">25</span>BEGIN 
<span class="linenos">26</span>  IF tag_id &lt;= 100 THEN population = 1; -- Negligible
<span class="linenos">27</span>  ELSIF 100 &lt; tag_id AND tag_id &lt;= 200 THEN  population = GREATEST(2, area * 0.0002); -- Very Sparse
<span class="linenos">28</span>  ELSIF 200 &lt; tag_id AND tag_id &lt;= 300 THEN  population = GREATEST(3, area * 0.002); -- Sparse
<span class="linenos">29</span>  ELSIF 300 &lt; tag_id AND tag_id &lt;= 400 THEN population = GREATEST(5,  area * 0.05); -- Moderate
<span class="linenos">30</span>  ELSIF 400 &lt; tag_id AND tag_id &lt;= 500  THEN population = GREATEST(7, area * 0.7); -- Dense
<span class="linenos">31</span>  ELSIF tag_id &gt; 500  THEN population = GREATEST(10,area * 1); -- Very Dense
<span class="linenos">32</span>  ELSE population = 1;
<span class="linenos">33</span>  END IF;
<span class="linenos">34</span>  RETURN population;
<span class="linenos">35</span>END;
<span class="linenos">36</span>$BODY$
<span class="linenos">37</span>LANGUAGE plpgsql;
<span class="linenos">38</span>\o buildings_population_calculation.txt
<span class="linenos">39</span>-- Adding a column for storing the population
<span class="linenos">40</span>ALTER TABLE buildings_ways
<span class="linenos">41</span>ADD COLUMN population INTEGER;
<span class="linenos">42</span>-- Storing the population
<span class="linenos">43</span>UPDATE buildings_ways 
<span class="linenos">44</span>SET population = population(tag_id,area)::INTEGER;
<span class="linenos">45</span>-- population_function_to_here
<span class="linenos">46</span>
<span class="linenos">47</span>-- nearest_road_from_here
<span class="linenos">48</span>
<span class="linenos">49</span>-- Create Function for finding the closest edge
<span class="linenos">50</span>CREATE OR REPLACE FUNCTION closest_edge(geom GEOMETRY)
<span class="linenos">51</span>RETURNS BIGINT AS
<span class="linenos">52</span>$BODY$
<span class="linenos">53</span>SELECT gid FROM roads_ways ORDER BY geom &lt;-&gt; the_geom LIMIT 1;
<span class="linenos">54</span>$BODY$
<span class="linenos">55</span>LANGUAGE SQL;
<span class="linenos">56</span>-- Add a column for storing the closest edge
<span class="linenos">57</span>ALTER TABLE buildings_ways
<span class="linenos">58</span>ADD COLUMN edge_id INTEGER;
<span class="linenos">59</span>-- Store the edge_id of the closest edge in the column
<span class="linenos">60</span>UPDATE buildings_ways SET edge_id = closest_edge(poly_geom);
<span class="linenos">61</span>-- nearest_road_to_here
<span class="linenos">62</span>
<span class="linenos">63</span>-- road_population_from_here
</pre></div>
</div>
<p>Following figure shows the output of the above query visualised in QGIS. Lines
highlighted in <code class="docutils literal notranslate"><span class="pre">yellow</span></code> show the <cite>generalised the roads served</cite>. This gives a better
estimate of the areas from where the hospital can be reached by a particular speed.</p>
<a class="reference internal image-reference" href="../_images/generalised_service_area.png"><img alt="../_images/generalised_service_area.png" class="align-center" src="../_images/generalised_service_area.png" style="width: 526.5px; height: 588.0px;" /></a>
</section>
</section>
<section id="calculating-the-population-residing-along-the-road">
<h3><a class="toc-backref" href="#id12"><span class="section-number">3.1.3. </span>Calculating the population residing along the road</a><a class="headerlink" href="#calculating-the-population-residing-along-the-road" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Now the next step is to estimate the dependant population. Official source of
population is Census conducted by the government. But for this exercise, population
will be estimated from the <code class="docutils literal notranslate"><span class="pre">area</span></code> as well as the <code class="docutils literal notranslate"><span class="pre">category</span></code> of the building.
This area will be stored in the nearest roads. Following steps explain the
process in detail.</p>
<section id="estimating-the-population-of-buildings">
<h4><a class="toc-backref" href="#id13"><span class="section-number">3.1.3.1. </span>Estimating the population of buildings</a><a class="headerlink" href="#estimating-the-population-of-buildings" title="Enlazar permanentemente con este título">¶</a></h4>
<p>Population of an building can be estimated by its area and its category.
Buildings of OpenStreetMap data are classified into various categories. For
this exercise, the buildings are classified into the following classes:</p>
<ul class="simple">
<li><p>Negligible: People do not live in these places. But the default is 1 because of
homeless people.</p></li>
<li><p>Very Sparse: People do not live in these places. But the default is 2 because
there may be people guarding the place.</p></li>
<li><p>Sparse: Considering the universities and college because the students live there.</p></li>
<li><p>Moderate: A family unit housing kind of location.</p></li>
<li><p>Dense: A medium sized residential building.</p></li>
<li><p>Very Dense: A large sized residential building.</p></li>
</ul>
<p>The class-specific factor is multiplied with the area of each building to get
the population</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span>CREATE OR REPLACE FUNCTION  population(tag_id INTEGER,area INTEGER)
<span class="linenos"> 2</span>RETURNS INTEGER AS 
<span class="linenos"> 3</span>$BODY$
<span class="linenos"> 4</span>DECLARE 
<span class="linenos"> 5</span>population INTEGER;
<span class="linenos"> 6</span>BEGIN 
<span class="linenos"> 7</span>  IF tag_id &lt;= 100 THEN population = 1; -- Negligible
<span class="linenos"> 8</span>  ELSIF 100 &lt; tag_id AND tag_id &lt;= 200 THEN  population = GREATEST(2, area * 0.0002); -- Very Sparse
<span class="linenos"> 9</span>  ELSIF 200 &lt; tag_id AND tag_id &lt;= 300 THEN  population = GREATEST(3, area * 0.002); -- Sparse
<span class="linenos">10</span>  ELSIF 300 &lt; tag_id AND tag_id &lt;= 400 THEN population = GREATEST(5,  area * 0.05); -- Moderate
<span class="linenos">11</span>  ELSIF 400 &lt; tag_id AND tag_id &lt;= 500  THEN population = GREATEST(7, area * 0.7); -- Dense
<span class="linenos">12</span>  ELSIF tag_id &gt; 500  THEN population = GREATEST(10,area * 1); -- Very Dense
<span class="linenos">13</span>  ELSE population = 1;
<span class="linenos">14</span>  END IF;
<span class="linenos">15</span>  RETURN population;
<span class="linenos">16</span>END;
<span class="linenos">17</span>$BODY$
<span class="linenos">18</span>LANGUAGE plpgsql;
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>All these are estimations based on this particular area. More complicated
functions can be done that consider height of the apartments but the
design of a function is going to depend on the availability of the data.
For example, using census data can achieve more accurate estimation.</p>
</div>
<p>Add a column for storing the population in the <code class="docutils literal notranslate"><span class="pre">buildings_ways</span></code></p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">buildings_ways</span>
<span class="linenos">2</span><span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">population</span> <span class="nb">INTEGER</span><span class="p">;</span>
</pre></div>
</div>
<p>Use the <code class="docutils literal notranslate"><span class="pre">population</span></code> function to store the population in the new column created
in the <code class="docutils literal notranslate"><span class="pre">building_ways</span></code>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">UPDATE</span> <span class="n">buildings_ways</span> 
<span class="linenos">2</span><span class="k">SET</span> <span class="n">population</span> <span class="o">=</span> <span class="n">population</span><span class="p">(</span><span class="n">tag_id</span><span class="p">,</span><span class="n">area</span><span class="p">)::</span><span class="nb">INTEGER</span><span class="p">;</span>
</pre></div>
</div>
</section>
<section id="finding-the-nearest-roads-to-store-the-population">
<h4><a class="toc-backref" href="#id14"><span class="section-number">3.1.3.2. </span>Finding the nearest roads to store the population</a><a class="headerlink" href="#finding-the-nearest-roads-to-store-the-population" title="Enlazar permanentemente con este título">¶</a></h4>
<p>To store the population of buildings in the roads, nearest road to a building
is to be found. Create Function for finding the closest edge.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span>CREATE OR REPLACE FUNCTION closest_edge(geom GEOMETRY)
<span class="linenos">2</span>RETURNS BIGINT AS
<span class="linenos">3</span>$BODY$
<span class="linenos">4</span>SELECT gid FROM roads_ways ORDER BY geom &lt;-&gt; the_geom LIMIT 1;
<span class="linenos">5</span>$BODY$
<span class="linenos">6</span>LANGUAGE SQL;
</pre></div>
</div>
<p>Add a column in <code class="docutils literal notranslate"><span class="pre">buildings_ways</span></code> for storing the id of closest edge</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">buildings_ways</span>
<span class="linenos">2</span><span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">edge_id</span> <span class="nb">INTEGER</span><span class="p">;</span>
</pre></div>
</div>
<p>Store the edge id of the closest edge in the new column</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">UPDATE</span> <span class="n">buildings_ways</span> <span class="k">SET</span> <span class="n">edge_id</span> <span class="o">=</span> <span class="n">closest_edge</span><span class="p">(</span><span class="n">poly_geom</span><span class="p">);</span>
</pre></div>
</div>
</section>
<section id="storing-the-population-in-the-roads">
<h4><a class="toc-backref" href="#id15"><span class="section-number">3.1.3.3. </span>Storing the population in the roads</a><a class="headerlink" href="#storing-the-population-in-the-roads" title="Enlazar permanentemente con este título">¶</a></h4>
<p>After finding the nearest road, the sum of population of all the nearest
buildings is stored in the population column of the roads table.</p>
<p>Add a column in <code class="docutils literal notranslate"><span class="pre">roads_ways</span></code> for storing population</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">ALTER</span> <span class="k">TABLE</span> <span class="n">roads_ways</span>
<span class="linenos">2</span><span class="k">ADD</span> <span class="k">COLUMN</span> <span class="n">population</span> <span class="nb">INTEGER</span><span class="p">;</span>
</pre></div>
</div>
<p>Update the roads with the sum of population of buildings closest to it</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">UPDATE</span> <span class="n">roads_ways</span> <span class="k">SET</span> <span class="n">population</span> <span class="o">=</span> <span class="k">SUM</span>
<span class="linenos">2</span><span class="k">FROM</span> <span class="p">(</span>
<span class="linenos">3</span>	<span class="k">SELECT</span> <span class="n">edge_id</span><span class="p">,</span> <span class="k">SUM</span><span class="p">(</span><span class="n">population</span><span class="p">)</span> 
<span class="linenos">4</span>	<span class="k">FROM</span> <span class="n">buildings_ways</span> <span class="k">GROUP</span> <span class="k">BY</span> <span class="n">edge_id</span>
<span class="linenos">5</span>	<span class="p">)</span> 
<span class="linenos">6</span><span class="k">AS</span> <span class="n">subquery</span> 
<span class="linenos">7</span><span class="k">WHERE</span> <span class="n">gid</span> <span class="o">=</span> <span class="n">edge_id</span><span class="p">;</span>                                                                                                                       
</pre></div>
</div>
<p>Verify is the population is stored using the folowing query.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="k">SELECT</span> <span class="n">population</span> <span class="k">FROM</span> <span class="n">roads_ways</span> <span class="k">WHERE</span> <span class="n">gid</span> <span class="o">=</span> <span class="mi">441</span><span class="p">;</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/road_population.png"><img alt="../_images/road_population.png" class="align-center" src="../_images/road_population.png" style="width: 461.25px; height: 474.75px;" /></a>
</section>
</section>
<section id="finding-total-population-served-by-the-hospital-based-on-travel-time">
<h3><a class="toc-backref" href="#id16"><span class="section-number">3.1.4. </span>Finding total population served by the hospital based on travel-time</a><a class="headerlink" href="#finding-total-population-served-by-the-hospital-based-on-travel-time" title="Enlazar permanentemente con este título">¶</a></h3>
<p>Use the query from 3.1.2.3 as a subquery to get all the edges in the roads served.
Note that <code class="docutils literal notranslate"><span class="pre">s.population</span></code> is added in line 14 which gves the population.
After getting the population for each edge/road, use <code class="docutils literal notranslate"><span class="pre">sum()</span></code> to get the total
population which is dependant on the hospital.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="k">WITH</span> <span class="n">subquery</span>
<span class="linenos"> 2</span><span class="k">AS</span> <span class="p">(</span>
<span class="linenos"> 3</span>	<span class="k">WITH</span> <span class="n">subquery</span> <span class="k">AS</span> <span class="p">(</span>
<span class="linenos"> 4</span>	<span class="k">SELECT</span> <span class="n">r</span><span class="p">.</span><span class="n">gid</span><span class="p">,</span><span class="k">source</span><span class="p">,</span><span class="n">target</span><span class="p">,</span><span class="n">agg_cost</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="n">population</span><span class="p">,</span><span class="n">r</span><span class="p">.</span><span class="n">the_geom</span> 
<span class="linenos"> 5</span>	<span class="k">FROM</span> <span class="n">pgr_drivingDistance</span><span class="p">(</span>
<span class="linenos"> 6</span>		    <span class="s1">&#39;SELECT gid as id,source,target, length_m/60 AS cost, length_m/60 AS reverse_cost </span>
<span class="linenos"> 7</span><span class="s1">		    FROM roads.roads_ways&#39;</span><span class="p">,</span>
<span class="linenos"> 8</span>		    <span class="p">(</span><span class="k">SELECT</span> <span class="n">closest_vertex</span><span class="p">(</span><span class="n">poly_geom</span><span class="p">)</span> 
<span class="linenos"> 9</span>		    <span class="k">FROM</span> <span class="n">buildings</span><span class="p">.</span><span class="n">buildings_ways</span> 
<span class="linenos">10</span>		    <span class="k">WHERE</span> <span class="n">tag_id</span> <span class="o">=</span> <span class="s1">&#39;318&#39;</span>
<span class="linenos">11</span>		    <span class="p">),</span> <span class="mi">10</span><span class="p">,</span> <span class="k">FALSE</span>
<span class="linenos">12</span>		  <span class="p">),</span><span class="n">roads</span><span class="p">.</span><span class="n">roads_ways</span> <span class="k">AS</span> <span class="n">r</span>
<span class="linenos">13</span>	<span class="k">WHERE</span> <span class="n">edge</span> <span class="o">=</span> <span class="n">r</span><span class="p">.</span><span class="n">gid</span><span class="p">)</span>
<span class="linenos">14</span>	<span class="k">SELECT</span> <span class="n">r</span><span class="p">.</span><span class="n">gid</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="n">the_geom</span><span class="p">,</span> <span class="n">s</span><span class="p">.</span><span class="n">population</span>
<span class="linenos">15</span>	<span class="k">FROM</span> <span class="n">subquery</span> <span class="k">AS</span> <span class="n">s</span><span class="p">,</span><span class="n">roads</span><span class="p">.</span><span class="n">roads_ways</span> <span class="k">AS</span> <span class="n">r</span> 
<span class="linenos">16</span>	<span class="k">WHERE</span> <span class="n">r</span><span class="p">.</span><span class="k">source</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="k">source</span> <span class="k">OR</span> <span class="n">r</span><span class="p">.</span><span class="n">target</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">target</span>
<span class="linenos">17</span>	<span class="p">)</span>
<span class="linenos">18</span><span class="k">SELECT</span> <span class="k">SUM</span><span class="p">(</span><span class="n">population</span><span class="p">)</span> <span class="k">FROM</span> <span class="n">subquery</span><span class="p">;</span>
</pre></div>
</div>
</section>
</section>
</section>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2010-2021 Daniel Kastl, Vicky Vergara.<br/>
      Actualizado por última vez en sept. 17, 2021.<br/>
    </p>
  </div>
</footer>
  </body>
</html>